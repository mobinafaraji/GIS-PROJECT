<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>WebGIS Map with Dynamic Legend</title>
  <!-- OpenLayers CSS from CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@latest/ol.css">
  <!-- LayerSwitcher CSS from CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol-layerswitcher@latest/dist/ol-layerswitcher.css">
  <link rel="stylesheet" href="css/main.css">
</head>

<body>

  <!-- Back Button -->
  <div class="container">
    <button class="btn btn-secondary mb-4" onclick="goBack()">Back</button>
  </div>

  <!-- Map Container -->
  <div id="map" class="map"></div>

  <!-- Dynamic Legend (bottom-left) -->
  <div id="legend" class="legend-box"></div>

  <!-- Mouse Coordinates (bottom-right) -->
  <div id="mouse-position" class="mouse-position"></div>

  <!-- OpenLayers & LayerSwitcher scripts from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/ol@latest/dist/ol.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ol-layerswitcher@latest"></script>

  <script>
    // Define your map layers
    const baseLayer = new ol.layer.Tile({
      source: new ol.source.OSM(),
      title: 'OpenStreetMap', // Title for the base layer
    });

    const vectorLayer = new ol.layer.Vector({
      source: new ol.source.Vector({
        url: 'data.geojson', // Your GeoJSON or vector data source
        format: new ol.format.GeoJSON(),
      }),
      title: 'PM10 2022', // Title for the vector layer (we will hide this in the legend)
      // Example color for legend
      layerColor: '#ffcc00'
    });

    // Create the map
    const map = new ol.Map({
      target: 'map',
      layers: [baseLayer, vectorLayer],
      view: new ol.View({
        center: [0, 0],
        zoom: 4,
      }),
    });

    // Add LayerSwitcher control to the map
    const layerSwitcher = new ol.control.LayerSwitcher({
      showRoot: false,
      groupSelectStyle: 'none',
    });
    map.addControl(layerSwitcher);

    // Custom Legend (without layer names)
    const legend = document.getElementById('legend');
    map.getLayers().forEach(function (layer) {
      if (layer.get('layerColor')) {
        const listItem = document.createElement('div');
        listItem.style.backgroundColor = layer.get('layerColor');
        listItem.style.width = '24px';
        listItem.style.height = '24px';
        listItem.style.marginBottom = '4px';
        legend.appendChild(listItem);
      }
    });

    // Back button functionality
    function goBack() {
      window.history.back();
    }
  </script>
</body>

</html>